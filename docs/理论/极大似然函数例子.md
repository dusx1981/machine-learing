## 示例：硬币投掷实验

### 1. 问题设定
假设我们有一枚可能不均匀的硬币，我们不知道它正面朝上的真实概率 $ p $。为了估计 $ p $，我们进行了10次投掷实验，观测到的数据如下：

**观测数据**：1, 0, 1, 1, 0, 1, 1, 1, 0, 1

其中：
- 1 表示正面朝上
- 0 表示反面朝上

### 2. 数据整理与统计
从观测数据中，我们可以计算出：
- 总投掷次数：$ n = 10 $
- 正面朝上的次数：$ k = 7 $（数一下1的个数）
- 反面朝上的次数：$ n - k = 3 $

### 3. 建立概率模型
对于单次伯努利试验，概率质量函数为：
$$
f(x_i \mid p) = 
\begin{cases} 
p & \text{如果 } x_i = 1 \\
1-p & \text{如果 } x_i = 0 
\end{cases}
$$

可以统一写成：
$$
f(x_i \mid p) = p^{x_i}(1-p)^{1-x_i}
$$

### 4. 构建似然函数
由于各次投掷是独立的，似然函数是各观测值概率的乘积：
$$
L(p \mid x_1, \ldots, x_{10}) = \prod_{i=1}^{10} p^{x_i}(1-p)^{1-x_i}
$$

代入我们的观测数据：
$$
L(p) = p^1(1-p)^0 \times p^0(1-p)^1 \times p^1(1-p)^0 \times \cdots \times p^1(1-p)^0
$$

简化后：
$$
L(p) = p^7 (1-p)^3
$$

### 5. 构建对数似然函数
为了简化计算，取对数：
$$
\ell(p) = \log L(p) = 7 \log p + 3 \log (1-p)
$$

### 6. 求解极大似然估计
对对数似然函数求导并令导数为零：
$$
\frac{d\ell}{dp} = \frac{7}{p} - \frac{3}{1-p} = 0
$$

解方程：
$$
\frac{7}{p} = \frac{3}{1-p}
$$
$$
7(1-p) = 3p
$$
$$
7 - 7p = 3p
$$
$$
7 = 10p
$$
$$
p = 0.7
$$

### 7. 结果解释
极大似然估计值为 $ \hat{p}_{\text{MLE}} = 0.7 $，这恰好等于观测数据中正面朝上的频率：
$$
\hat{p} = \frac{\text{正面次数}}{\text{总次数}} = \frac{7}{10} = 0.7
$$

### 8. 可视化理解

```
似然函数 L(p) = p⁷(1-p)³

p     | L(p)      | 解释
------|-----------|-------------------
0.5   | 0.00098   | 可能性较低
0.6   | 0.00179   | 可能性提高
0.7   | 0.00222   | 最大值 ← MLE
0.8   | 0.00168   | 可能性降低
0.9   | 0.00048   | 可能性很低
```

### 9. 二阶导数检验
为了确认这是最大值点，计算二阶导数：
$$
\frac{d^2\ell}{dp^2} = -\frac{7}{p^2} - \frac{3}{(1-p)^2} < 0
$$
由于二阶导数为负，确认 $ p = 0.7 $ 是极大值点。

## 关键要点

1. **观测数据的作用**：观测数据（1,0,1,1,0,1,1,1,0,1）直接决定了似然函数的形式 $ L(p) = p^7(1-p)^3 $

2. **直觉理解**：MLE选择了最能使观测数据"合理"的参数值。如果真实概率确实是0.7，那么我们观测到7次正面、3次反面的概率是最大的。

3. **频率解释**：对于伯努利试验，MLE正好等于成功频率，这体现了频率学派与极大似然估计的自然联系。

4. **数据变化的影响**：如果观测数据变为8次正面、2次反面，那么MLE会变为 $ \hat{p} = 0.8 $，体现了估计对数据的依赖性。

这个例子清晰地展示了如何从具体的观测数据出发，通过构建似然函数，最终得到参数的极大似然估计。