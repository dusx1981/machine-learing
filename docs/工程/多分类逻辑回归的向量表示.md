# 多分类中的向量方向：为什么权重是行向量，输入是列向量

## 一、标准表示法

在多分类问题中，标准的数学表示是：

### 1. 输入特征向量
输入 $\mathbf{x}$ 是一个 **列向量**：
$$
\mathbf{x} = \begin{bmatrix} x_1 \\ x_2 \\ \vdots \\ x_d \end{bmatrix} \in \mathbb{R}^{d \times 1}
$$
其中 $d$ 是特征维度。

### 2. 权重矩阵
权重 $\mathbf{W}$ 是一个 **矩阵**：
$$
\mathbf{W} = \begin{bmatrix} \mathbf{w}_1^T \\ \mathbf{w}_2^T \\ \vdots \\ \mathbf{w}_C^T \end{bmatrix} = \begin{bmatrix} w_{11} & w_{12} & \cdots & w_{1d} \\ w_{21} & w_{22} & \cdots & w_{2d} \\ \vdots & \vdots & \ddots & \vdots \\ w_{C1} & w_{C2} & \cdots & w_{Cd} \end{bmatrix} \in \mathbb{R}^{C \times d}
$$
其中：
- 每一行 $\mathbf{w}_i^T$ 是第 $i$ 个类别的权重向量（**行向量**）
- 每个权重向量 $\mathbf{w}_i \in \mathbb{R}^{d \times 1}$ 本质上是列向量，但作为行向量转置的形式出现在矩阵中

### 3. 偏置向量
偏置 $\mathbf{b}$ 是一个 **列向量**：
$$
\mathbf{b} = \begin{bmatrix} b_1 \\ b_2 \\ \vdots \\ b_C \end{bmatrix} \in \mathbb{R}^{C \times 1}
$$

### 4. 线性输出
线性输出 $\mathbf{z}$ 是：
$$
\mathbf{z} = \mathbf{W} \mathbf{x} + \mathbf{b} \in \mathbb{R}^{C \times 1}
$$
这是一个**矩阵-向量乘法**，结果是一个列向量。

---

## 二、具体示例：为什么这样设计

### 示例数据
假设：
- 特征维度 $d = 3$
- 类别数 $C = 2$
- 输入：$\mathbf{x} = [1, 2, 3]^T$（列向量）
- 权重矩阵：
  $$
  \mathbf{W} = \begin{bmatrix} 0.1 & 0.2 & 0.3 \\ -0.1 & 0.0 & 0.1 \end{bmatrix}
  $$
  即：
  - 类别1权重行向量：$\mathbf{w}_1^T = [0.1, 0.2, 0.3]$
  - 类别2权重行向量：$\mathbf{w}_2^T = [-0.1, 0.0, 0.1]$
- 偏置：$\mathbf{b} = [0.5, -0.2]^T$

### 计算过程
#### 方法1：矩阵乘法（标准形式）
$$
\mathbf{z} = \mathbf{W} \mathbf{x} + \mathbf{b} = \begin{bmatrix} 0.1 & 0.2 & 0.3 \\ -0.1 & 0.0 & 0.1 \end{bmatrix} \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix} + \begin{bmatrix} 0.5 \\ -0.2 \end{bmatrix}
$$

计算：
$$
\begin{aligned}
z_1 &= (0.1 \times 1) + (0.2 \times 2) + (0.3 \times 3) + 0.5 = 0.1 + 0.4 + 0.9 + 0.5 = 1.9 \\
z_2 &= (-0.1 \times 1) + (0.0 \times 2) + (0.1 \times 3) + (-0.2) = -0.1 + 0.0 + 0.3 - 0.2 = 0.0
\end{aligned}
$$
所以 $\mathbf{z} = [1.9, 0.0]^T$。

#### 方法2：逐类别计算（等价形式）
每个类别的线性输出：
$$
\begin{aligned}
z_1 &= \mathbf{w}_1^T \mathbf{x} + b_1 = [0.1, 0.2, 0.3] \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix} + 0.5 = 1.4 + 0.5 = 1.9 \\
z_2 &= \mathbf{w}_2^T \mathbf{x} + b_2 = [-0.1, 0.0, 0.1] \begin{bmatrix} 1 \\ 2 \\ 3 \end{bmatrix} + (-0.2) = 0.2 - 0.2 = 0.0
\end{aligned}
$$

注意：这里 $\mathbf{w}_i^T$ 是行向量，$\mathbf{x}$ 是列向量，内积结果为标量。